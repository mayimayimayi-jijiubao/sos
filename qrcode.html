<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>急救宝信息展示</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- 本地 JS 引用 -->
<script src="./av-min.js"></script>

<script>
  AV.init({
    appId: "Ivzq5oxAhWX2BqNvdFKQbBjl-gzGzoHsz",
    appKey: "ESfT6VmHoUAzyc8Ay0ebZbuC",
    serverURL: "https://ivzq5oxa.lc-cn-n1-shared.com"
  });

  async function loadInfo() {
    const params = new URLSearchParams(window.location.search);
    const phone = params.get('phone');
    if (!phone) {
      document.getElementById('info').innerText = '⚠️ 未提供手机号参数';
      return;
    }

    try {
      const query = new AV.Query('UserInfo');
      query.equalTo('phone', phone);
      const obj = await query.first();
      if (!obj) {
        document.getElementById('info').innerText = '❌ 未找到对应信息';
        return;
      }

      const data = obj.toJSON();
      document.getElementById('info').innerHTML = `
        <div class="card">
          <h3>急救信息</h3>
          <p><strong>姓名：</strong>${data.name}</p>
          <p><strong>手机号：</strong>${data.phone}</p>
          <p><strong>紧急联系人：</strong>${data.emergencyName}</p>
          <p><strong>紧急联系电话：</strong>${data.emergencyPhone}</p>
        </div>
      `;
    } catch (err) {
      console.error(err);
      document.getElementById('info').innerText = '❌ 加载失败：' + err.message;
    }
  }

  window.onload = loadInfo;
</script>

<style>
body {
  font-family: sans-serif;
  margin: 30px;
  max-width: 480px;
}
.card {
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 20px;
  background: #f8f8f8;
}
h3 {
  color: #d9534f;
}
</style>
</head>

<body>
  <h2>急救宝信息展示</h2>
  <div id="info">⏳ 正在加载中...</div>
</body>
</html>
